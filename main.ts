enum ActionKind {
    Walking,
    Idle,
    Jumping,
    Dead
}
namespace SpriteKind {
    export const Ground = SpriteKind.create()
    export const Cloud = SpriteKind.create()
}
function initGround () {
    ground1 = sprites.create(img`
        .....................................................cccc..................cccc...................................................................................
        ....................................................c....c................c....c..................................................................................
        cccccccccccccccccccccccccccccccccccccccccccccccccccc......cccccccccccccccc......cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ....ccc..c.................ccc..c...........c..cccc..........................c.............c..cccc.........................cccc..c.......................c..cccc..
        ..................................................................................................................................................................
        ...............c..cccc...............c..................c..cccc.....c..cccc........c.cc..............c.......c.cccc.........................c..cccc...............
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ........................................................dddfffddd.................................................................................................
        .......................................................dddffdffffdddd..................................................ddddddddd..................................
        ......................................................dddfddddddffdddd...............................................dddffffdddddd................................
        ......................................................dddfdddddddfddddd.............................................dddffdddffddddd...............................
        ......................................................ddddddddddddddddd............................................dddfdddddddddddd...............................
        .....................................................ddddddddddddddddddd...........................................dddddddddddddddd...............................
        .....................................................dddffddddddddffdddd..........................................ddddddddddddddddd...............................
        .....................................................ddffffdddddffffddd...........................................dddffddddfffddd.................................
        .....................................................ddffffdddddffffddd...........................................ddfffddddfffdd..................................
        .....................................................dddfffddddddfdfddd...........................................ddfffdddddfd....................................
        .....................................................ffddddddddddfdffd.............................................dddddddfff.f...................................
        .....................................................ffdfdfffddfdfffff..............................................ddfddfffffff..................................
        ......................................................ffffffffffff.ff...............................................ffffffffffff..................................
        ......................................................f.ffffffff.f..f...............................................ff.fff....f...................................
        ...........................................................ff........................................................fff......f...................................
        .....................................................................................................................f........f...................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        `, SpriteKind.Ground)
    ground2 = sprites.create(img`
        .....................................................cccc..................cccc...................................................................................
        ....................................................c....c................c....c..................................................................................
        cccccccccccccccccccccccccccccccccccccccccccccccccccc......cccccccccccccccc......cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
        ..................................................................................................................................................................
        ..........ccc.....................................................................................................................................................
        ....ccc..c.................ccc..c...........c..cccc..........................c.............c..cccc.........................cccc..c.......................c..cccc..
        ................ddddddddffffffffdddddddd..........................................................................................................................
        ...............cddddddddffffffffdddddddd................c..cccc.....c..cccc........c.cc..............c.......c.cccc.........................c..cccc...............
        .............ddddddddfffffdddfffffffffffdddddddddd................................................................................................................
        ..........ddddddddfffddddddddddddddddfffffddddddddddd.............................................................................................................
        ..........ddddddddfffdddddddddddddddddddffdddddddddddddd..........................................................................................................
        ..........ddddddddfffdddddddddddddddddddffdddddddddddddd...............................................................ddddddddd..................................
        ..........dddddddddddddddddddddddddddddddddddddddddddddd.............................................................dddffffdddddd................................
        ........dddddddddddddddddddddddddddddddddddddddddddddddddd..........................................................dddffdddffddddd...............................
        ........ddddddddfffffdddddddddddddddddddddffffffdddddddddd.........................................................dddfdddddddddddd...............................
        ........ddddddddfffffdddddddddddddddddddddffffffdddddddddd.........................................................dddddddddddddddd...............................
        ........dddddfffffffffffdddddddddddddfffffffffffdddddddd..........................................................ddddddddddddddddd...............................
        ........dddddfffffffffffdddddddddddddfffffffffffdddddddd..........................................................dddffddddfffddd.................................
        ........ddddddddffffffffddddddddddddddddffdddfffdddddddd..........................................................ddfffddddfffdd..................................
        ........ddddddddffffffffddddddddddddddddffdddfffdddddddd..........................................................ddfffdddddfd....................................
        ........fffffdddddddddddddddddddddddddddffdddfffffddd..............................................................dddddddfff.f...................................
        ........fffffdddffdddffffffffdddddfffdddfffffffffffff...............................................................ddfddfffffff..................................
        ..........ffffffffffffffffffffffffffffffff...fffff..................................................................ffffffffffff..................................
        ..........ffffffffffffffffffffffffffffffff...fffff..................................................................ff.fff....f...................................
        ..........fff...fffffffffffffffffffff...ff......ff...................................................................fff......f...................................
        ........................fffff........................................................................................f........f...................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        `, SpriteKind.Ground)
    ground1.setPosition(scene.screenWidth() / 2, 120)
    ground2.setPosition(ground1.x + scene.screenWidth(), 120)
    ground1.vx = -100
    ground2.vx = -100
    ground1.z = 2
    ground2.z = 2
}
function initRaptor () {
    raptor = sprites.create(img`
        ..........ffffff................
        .........ffffffff...............
        .........ffdddfff...............
        .........dddddddf...............
        .........ddfddfdd...............
        .........dddddddd...............
        .........ddffdddd...............
        ..........ddfffd................
        ...........ddddd................
        .............d..................
        ....dd.......dd.................
        ..dd.dd....dddd.................
        .d.....d.dddddddd...dddd........
        dd.....ddddddddddd.d...dd.......
        d.......ddddddddddd.....dd......
        d.......ddddddddddd......d......
        d.......dddddddddd.......d......
        dd......dddddddddd.......d......
        .........ddddddddd.......d......
        .........ddddddddd.......d......
        .........eeeeeeeee..............
        .........eeeeeeeee..............
        ..........eeeeeee...............
        ...........e..e.................
        ...........d..d.................
        ...........d..d.................
        ...........d..d.................
        ...........d..d.................
        ...........f..f.................
        ........ffff..ffffff............
        .......fffff..fffffff...........
        ......ffffff..ffffffff..........
        `, SpriteKind.Player)
    run = animation.createAnimation(ActionKind.Walking, 100)
    run.addAnimationFrame(img`
        ..........ffffff................
        .........ffffffff...............
        .........ffdddfff...............
        .........dddddddf...............
        .........ddfddfdd...............
        .........dddddddd...............
        .........ddffdddd...............
        ..........ddfffd................
        ...........ddddd................
        .............d..................
        ..d..........dd.................
        .dd........dddd.................
        .dd......dddddddd...dddd........
        ..ddd...dddddddddd.d...dd.......
        ....ddddddddddddddd.....dd......
        ........ddddddddddd......d......
        ........dddddddddd.......d......
        ........dddddddddd.......d......
        .........ddddddddd.......d......
        .........ddddddddd.......d......
        .........eeeeeeeee..............
        .........eeeeeeeee..............
        ..........eeeeeee...............
        ...........e..e.................
        ...........d..d......ffff.......
        ...........d..dd....fffff.......
        ...........d..dddddffffff.......
        ...........d.......ffffff.......
        ...........f.......ffffff.......
        ........ffff.......fffff........
        .......fffff....................
        ......ffffff....................
        `)
    run.addAnimationFrame(img`
        ..........ffffff................
        .........ffffffff...............
        .........ffdddfff...............
        .........dddddddf...............
        .........ddfddfdd...............
        .........dddddddd...............
        .........ddffdddd...............
        ..........ddfffd................
        ...........ddddd................
        .............d..........d.......
        ....dd.......dd........dd.......
        ..dd.dd....dddd........d........
        .d.....d.dddddddd......d........
        dd.....ddddddddddd....dd........
        d.......dddddddddd...dd.........
        d.......dddddddddddddd..........
        d.......dddddddddd..............
        dd......dddddddddd..............
        .........ddddddddd..............
        .........ddddddddd..............
        .........eeeeeeeee..............
        .........eeeeeeeee..............
        ..ffff....eeeeeee...............
        ..fffff....e..e.................
        ..fffff....d..d.................
        ...ffff....d..d.................
        ...fffdddddd..d.................
        ....ff........d.................
        ..............f.................
        ..............ffffff............
        ..............fffffff...........
        ..............ffffffff..........
        `)
    animation.attachAnimation(raptor, run)
    jump = animation.createAnimation(ActionKind.Jumping, 200)
    jump.addAnimationFrame(img`
        ..........ffffff................
        .........ffffffff...............
        .........ffdddfff...............
        .........dddddddf...............
        .........ddfddfdd...............
        .........dddddddd...............
        .........ddffdddd...............
        ...d......ddfffd.......d........
        ...d.......ddddd......dd........
        ...d.........d........d.........
        ...ddd.......dd.......d.........
        .....dd....dddd......dd.........
        ......dd.dddddddd...d...........
        .......ddddddddddddd............
        ........ddddddddddd.............
        ........ddddddddddd.............
        ........dddddddddd..............
        ........dddddddddd..............
        .........ddddddddd..............
        .........ddddddddd..............
        ...ffff..eeeeeeeee..............
        ..fffff..eeeeeeeee..fff.........
        ..fffff...eeeeeee...fffff.......
        .ffffff....e..e.....ffffff......
        .fffff.....d..d.....ffffff......
        .ffffddd..dd..d......fffff......
        .......ddddd..dddddddffffff.....
        ......................fffff.....
        .........................ff.....
        ................................
        ................................
        ................................
        `)
    animation.attachAnimation(raptor, jump)
    dead = animation.createAnimation(ActionKind.Dead, 200)
    dead.addAnimationFrame(img`
        ..........ffffff................
        .........ffffffff...............
        .........ffdddfff...............
        .........dddddddf999............
        .....999999fddfd99.99999........
        ....99...dddddddd......99.......
        ...9.....ddffdddd.......9.......
        ...9......ddfffd........9.......
        ...........ddddd................
        .............2..................
        ....dd.......2d.................
        ..dd.dd....d22d.................
        .d..22.d.dd22dddd...d222........
        dd..2..dddd2dd2ddd.d...22.......
        d...2...dd22dd2dddd.....2d......
        d...2...dd2ddd2dddd.....2d......
        d...2...dd2ddd2ddd......2d......
        dd..2...dddddddddd......22......
        ....2...2ddddddddd.......2......
        ....2...2ddddddddd.......2......
        ....2...2eeeeeeeee.......22.....
        ........2eeeeeeeee..............
        ........2.eeeeeee...............
        ........2..e..e.................
        ........2..d..d.................
        ...........d..d.................
        ...........d..d.................
        ...........d..d.................
        ...........f..f.................
        ........ffff..ffffff............
        .......fffff..fffffff...........
        ......ffffff..ffffffff..........
        `)
    animation.attachAnimation(raptor, dead)
    raptor.z = 3
    raptor.setPosition(15, 94)
}
sprites.onOverlap(SpriteKind.Player, SpriteKind.Projectile, function (sprite, otherSprite) {
    end = 1
    animation.setAction(raptor, ActionKind.Dead)
    pause(50)
    game.over(false, effects.dissolve)
})
controller.anyButton.onEvent(ControllerButtonEvent.Pressed, function () {
    if (raptor.y == 94 && end == 0) {
        raptor.vy = -160
        animation.setAction(raptor, ActionKind.Jumping)
    }
})
let cloud: Sprite = null
let cactus: Sprite = null
let choice = 0
let dead: animation.Animation = null
let jump: animation.Animation = null
let run: animation.Animation = null
let raptor: Sprite = null
let ground2: Sprite = null
let ground1: Sprite = null
let end = 0
let idle = null
game.setDialogCursor(img`
    ..........ffffff................
    .........ffffffff...............
    .........ffdddfff...............
    .........dddddddf...............
    .........ddfddfdd...............
    .........dddddddd...............
    .........ddffdddd...............
    ..........ddfffd................
    ...........ddddd................
    .............d..................
    ....dd.......dd.................
    ..dd.dd....dddd.................
    .d.....d.dddddddd...dddd........
    dd.....ddddddddddd.d...dd.......
    d.......ddddddddddd.....dd......
    d.......ddddddddddd......d......
    d.......dddddddddd.......d......
    dd......dddddddddd.......d......
    .........ddddddddd.......d......
    .........ddddddddd.......d......
    .........eeeeeeeee..............
    .........eeeeeeeee..............
    ..........eeeeeee...............
    ...........e..e.................
    ...........d..d.................
    ...........d..d.................
    ...........d..d.................
    ...........d..d.................
    ...........f..f.................
    ........ffff..ffffff............
    .......fffff..fffffff...........
    ......ffffff..ffffffff..........
    `)
game.splash("Little timmy run")
scene.setBackgroundColor(9)
initGround()
initRaptor()
info.setScore(0)
end = 0
game.showLongText("Press any button to jump.", DialogLayout.Top)
game.onUpdate(function () {
    if (raptor.y < 94) {
        raptor.ay = 400
    } else {
        raptor.ay = 0
        raptor.y = 94
        if (end == 0) {
            animation.setAction(raptor, ActionKind.Walking)
        }
    }
})
game.onUpdateInterval(50, function () {
    info.changeScoreBy(1)
})
game.onUpdateInterval(1000, function () {
    ground1.vx += -1
    ground2.vx += -1
})
game.onUpdateInterval(1000, function () {
    choice = randint(0, 4)
    if (choice == 0) {
        cactus = sprites.createProjectileFromSide(img`
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ..............fff...............
            .............fffff..............
            .............fffff..............
            .............ddddd...f..........
            .........f...ffdff..fff.........
            ........fff..ffdff..ddd.........
            ........ddd..ddddd..ddd.........
            ........ddd..ddddd..ddd.........
            ........dddddddddd..ddd.........
            ........dddddfdddf..ddd.........
            .........dddddfffdddddd.........
            .............dddddddddd.........
            .............ddddddddd..........
            .............ddddd..............
            .............ddddd..............
            .............ddddd..............
            .............ddddd..............
            .............ddddd..............
            .............ddddd..............
            .............ddddd..............
            `, ground1.vx, 0)
        cactus.y = 94
        cactus.z = 2
    } else if (choice == 1) {
        cactus = sprites.createProjectileFromSide(img`
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ..............fff...............
            .............fffff..............
            .............fffff..............
            .............ddddd..............
            .........d...ddddd...d..........
            ........ddd..ffdff..ddd.........
            ........ddd..ffdff..ddd.........
            ........ddd..ddddd..ddd.........
            ........ddd..dddddddddd.........
            ........ddd..dddddddddd.........
            ........dddddfdddfdddd..........
            ........dddddffdff..............
            .........dddddfffd..............
            .............ddddd..............
            .............ddddd..............
            .............ddddd..............
            .............ddddd..............
            .............ddddd..............
            .............ddddd..............
            .............ddddd..............
            `, ground1.vx, 0)
        cactus.y = 94
        cactus.z = 2
    } else if (choice == 2) {
        cactus = sprites.createProjectileFromSide(img`
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ...........f....................
            ..........fff...................
            ..........ddd......f............
            ........d.fdf.....fff...........
            ........d.ddd.....ddd.d.........
            ........ddddd.d...fdf.d.........
            ..........fdf.d.d.ddddd.........
            ..........dfddd.d.fdf...........
            ..........ddd...dddfd...........
            ..........ddd.....ddd...........
            ..........ddd.....ddd...........
            ..........ddd.....ddd...........
            `, ground1.vx, 0)
        cactus.y = 94
        cactus.z = 2
    }
})
game.onUpdateInterval(1500, function () {
    if (Math.percentChance(40)) {
        cloud = sprites.createProjectileFromSide(img`
            ................................
            ................................
            ................................
            ................................
            ................................
            .......ff.......................
            .....fffff..........f.f..f......
            ....ffffffff.......fffff.f......
            ....ffffffff.......ffffffff.....
            ...ffdfffffff.......dfffdffd....
            ....ddddddddd......dddddddfd....
            ....ddfddfddd.....ddddddddddd...
            ....ddddddddd....ddffffdddfdd...
            ....ddddddddd....ddffffddfffd...
            ....ddffddfdd...7d77dffddfffd...
            ....dddffffdd..77ddfdd7ddfffd...
            .dd...dddddd.777.ddfdd777dddd...
            ..dd....d.d..7...ddffddd777d....
            ...d....d.d..7....ddffdddddd....
            ....d...d.d777.....dddfffdd777..
            ....dd..d77..........dddddd..7..
            .....d7777............dddd...77.
            .....7........................7.
            .77.77..7......................7
            77.......77777777777777777777777
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            `, ground1.vx / 4, 0)
        cloud.y = randint(20, 60)
        cloud.setKind(SpriteKind.Cloud)
        cloud.z = 1
    }
})
forever(function () {
    if (ground2.x < -1 * (scene.screenWidth() / 2)) {
        ground2.x = ground1.x + scene.screenWidth()
    }
})
forever(function () {
    if (ground1.x < -1 * (scene.screenWidth() / 2)) {
        ground1.x = ground2.x + scene.screenWidth()
    }
})
